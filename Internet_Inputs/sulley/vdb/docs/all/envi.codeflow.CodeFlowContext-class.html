<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>envi.codeflow.CodeFlowContext</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="envi-module.html">Package&nbsp;envi</a> ::
        <a href="envi.codeflow-module.html">Module&nbsp;codeflow</a> ::
        Class&nbsp;CodeFlowContext
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="envi.codeflow.CodeFlowContext-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class CodeFlowContext</h1><p class="nomargin-top"><span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext">source&nbsp;code</a></span></p>
<pre class="base-tree">
object --+
         |
        <strong class="uidshort">CodeFlowContext</strong>
</pre>

<dl><dt>Known Subclasses:</dt>
<dd>
      <ul class="subclass-list">
<li><a href="vdb.stalker.StalkerCodeFlow-class.html">vdb.stalker.StalkerCodeFlow</a></li>  </ul>
</dd></dl>

<hr />
<pre class="literalblock">

A CodeFlowContext is used for code-flow (not linear) based disassembly
for an envi MemoryObject (which is responsible for knowing the implementation
of parseOpcode().  The CodeFlowContext will optionally notify several callback
handlers for different events which occur during disassembly:

self._cb_opcode(va, op, branches) - called for every newly parsed opcode
    NOTE: _cb_opcode must return the desired branches for continued flow

self._cb_function(fva, metadict) - called once for every function

self._cb_branchtable(tabva, destva) - called for switch tables

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="envi.codeflow.CodeFlowContext-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">mem</span>)</span><br />
      x.__init__(...) initializes x; see x.__class__.__doc__ for signature</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_cb_branchtable"></a><span class="summary-sig-name">_cb_branchtable</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">tabva</span>,
        <span class="summary-sig-arg">destva</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext._cb_branchtable">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="envi.codeflow.CodeFlowContext-class.html#_cb_function" class="summary-sig-name" onclick="show_private();">_cb_function</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">fva</span>,
        <span class="summary-sig-arg">fmeta</span>)</span><br />
      Extend CodeFlowContext and implement this method to recieve a 
      callback for every newly discovered function.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext._cb_function">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_cb_opcode"></a><span class="summary-sig-name">_cb_opcode</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">va</span>,
        <span class="summary-sig-arg">op</span>,
        <span class="summary-sig-arg">branches</span>)</span><br />
      Extend CodeFlowContext and implement this method to recieve a 
      callback for every newly discovered opcode.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext._cb_opcode">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_handleFunc"></a><span class="summary-sig-name">_handleFunc</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">va</span>,
        <span class="summary-sig-arg">pth</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext._handleFunc">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="envi.codeflow.CodeFlowContext-class.html#addCodeFlow" class="summary-sig-name">addCodeFlow</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">va</span>,
        <span class="summary-sig-arg">persist</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">exptable</span>=<span class="summary-sig-default">True</span>)</span><br />
      Do code flow disassembly from the specified address.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.addCodeFlow">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addEntryPoint"></a><span class="summary-sig-name">addEntryPoint</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">va</span>)</span><br />
      Analyze the given procedure entry point and flow downward to find all
      subsequent code blocks and procedure edges.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.addEntryPoint">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addFunctionDef"></a><span class="summary-sig-name">addFunctionDef</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">fva</span>,
        <span class="summary-sig-arg">calls_from</span>)</span><br />
      Add a priori knowledge of a function to the code flow stuff...</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.addFunctionDef">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="getCallsFrom"></a><span class="summary-sig-name">getCallsFrom</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">fva</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.getCallsFrom">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">mem</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>x.__init__(...) initializes x; see x.__class__.__doc__ for 
  signature</p>
  <dl class="fields">
    <dt>Overrides:
        object.__init__
        <dd><em class="note">(inherited documentation)</em></dd>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="_cb_function"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_cb_function</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">fva</span>,
        <span class="sig-arg">fmeta</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext._cb_function">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Extend CodeFlowContext and implement this method to recieve a callback
  for every newly discovered function.  Additionally, metadata about the 
  function may be stored in the fmeta dict.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="addCodeFlow"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">addCodeFlow</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">va</span>,
        <span class="sig-arg">persist</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">exptable</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="envi.codeflow-pysrc.html#CodeFlowContext.addCodeFlow">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Do code flow disassembly from the specified address.  Returnes a list 
  of the procedural branch targets discovered during code flow...</p>
  <p>Set persist=True to store 'opdone' and never disassemble the same 
  thing twice Set exptable=True to expand branch tables in this phase</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Nov 16 18:22:12 2012
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
